# @about-me/fp - ä½¿ç”¨æŒ‡å—

TypeScript å‡½æ•°å¼ç¼–ç¨‹å·¥å…·åº“ï¼Œæä¾› 11 ä¸ªæ ¸å¿ƒ FP å·¥å…·ã€‚

## å¯¼å…¥

```typescript
import { pipe, compose, curry, tap, memoize } from '@about-me/fp'
```

---

## å‡½æ•°åˆ†ç±»å’Œå¿«é€Ÿå‚è€ƒ

### ç»„åˆå‡½æ•°ï¼ˆCompositionï¼‰
- `pipe` - ä»å·¦åˆ°å³ç»„åˆå‡½æ•°ï¼Œæ”¯æŒåŒæ­¥å’Œå¼‚æ­¥
- `compose` - ä»å³åˆ°å·¦ç»„åˆå‡½æ•°ï¼ˆæ•°å­¦é£æ ¼ï¼‰

### å‡½æ•°è½¬æ¢ï¼ˆFunction Transformationï¼‰
- `curry` - æŸ¯é‡ŒåŒ–ï¼šå¤šå‚æ•°å‡½æ•° â†’ å•å‚æ•°å‡½æ•°åºåˆ—
- `partial` - éƒ¨åˆ†åº”ç”¨ï¼šå›ºå®šå‡½æ•°çš„éƒ¨åˆ†å‚æ•°

### å‰¯ä½œç”¨å’Œè°ƒè¯•ï¼ˆDebugging & Side Effectsï¼‰
- `tap` - æ‰§è¡Œå‰¯ä½œç”¨ä½†ä¸æ”¹å˜å€¼ï¼Œæ”¯æŒåŒæ­¥å’Œå¼‚æ­¥

### åŸºç¡€å·¥å…·ï¼ˆUtilitiesï¼‰
- `identity` - è¿”å›è¾“å…¥å€¼æœ¬èº«
- `constant` - è¿”å›å¸¸é‡å‡½æ•°

### æ€§èƒ½ä¼˜åŒ–ï¼ˆPerformanceï¼‰
- `memoize` - ç¼“å­˜å‡½æ•°ç»“æœï¼ˆé¿å…é‡å¤è®¡ç®—ï¼‰
- `debounce` - é˜²æŠ–ï¼ˆå»¶è¿Ÿæ‰§è¡Œï¼Œé€‚åˆæœç´¢è¾“å…¥ï¼‰
- `throttle` - èŠ‚æµï¼ˆé™åˆ¶æ‰§è¡Œé¢‘ç‡ï¼Œé€‚åˆæ»šåŠ¨äº‹ä»¶ï¼‰

---

## è¯¦ç»† API å‚è€ƒ

### 1. pipe - ä»å·¦åˆ°å³çš„å‡½æ•°ç»„åˆ

**ç­¾å**ï¼š
```typescript
pipe<T>(value: T, ...fns: Array<(arg: any) => any>): any
```

**ç”¨é€”**ï¼šåˆ›å»ºæ•°æ®å¤„ç†ç®¡é“ï¼Œä»å·¦åˆ°å³ä¾æ¬¡åº”ç”¨å‡½æ•°

**ç‰¹æ€§**ï¼š
- æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥å‡½æ•°æ··ç”¨
- è‡ªåŠ¨æ£€æµ‹ Promise å¹¶åˆ‡æ¢åˆ°å¼‚æ­¥æ¨¡å¼
- æœ€å¤šæ”¯æŒ 10 ä¸ªå‡½æ•°çš„ç²¾ç¡®ç±»å‹æ¨å¯¼

**ä½¿ç”¨åœºæ™¯**ï¼š
- æ•°æ®è½¬æ¢æµç¨‹
- å¤šæ­¥éª¤å¤„ç†
- æ¸…æ™°çš„æ•°æ®æµå‘
- åŒæ­¥å¼‚æ­¥æ··åˆæ“ä½œ

**ä»£ç ç¤ºä¾‹**ï¼š
```typescript
// åŸºç¡€ç”¨æ³•
const result = pipe(
  5,
  x => x * 2,      // 10
  x => x + 10,     // 20
  x => x / 2       // 10
) // ç»“æœ: 10

// å®é™…åº”ç”¨ï¼šç”¨æˆ·æ•°æ®å¤„ç†
const processUser = (userData) => pipe(
  userData,
  validateUser,
  normalizeEmail,
  hashPassword,
  saveToDatabase
)

// æ•°ç»„å¤„ç†
const numbers = pipe(
  [1, 2, 3, 4, 5],
  arr => arr.filter(x => x > 2),
  arr => arr.map(x => x * 2),
  arr => arr.reduce((sum, x) => sum + x, 0)
) // 24

// å¼‚æ­¥æ“ä½œï¼ˆè‡ªåŠ¨æ£€æµ‹ï¼‰
const result = await pipe(
  userId,
  async id => await fetchUser(id),  // async
  user => user.name,                 // sync
  async name => await logToDatabase(name), // async
  name => name.toUpperCase()         // sync
)

// Promise è¾“å…¥
const userPromise = Promise.resolve({ name: 'Alice' })
const name = await pipe(
  userPromise,
  user => user.name,
  name => name.toUpperCase()
) // "ALICE"
```

---

### 2. pipeAsync - å¼‚æ­¥å‡½æ•°ç»„åˆ

**ç­¾å**ï¼š
```typescript
pipeAsync<T>(value: T, ...fns: Array<(arg: any) => any | Promise<any>>): Promise<any>
```

**ç”¨é€”**ï¼šç»„åˆå¼‚æ­¥å‡½æ•°ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œ

**ä½¿ç”¨åœºæ™¯**ï¼š
- API è°ƒç”¨é“¾
- æ•°æ®åº“æ“ä½œ
- å¼‚æ­¥æ•°æ®è½¬æ¢

**ä»£ç ç¤ºä¾‹**ï¼š
```typescript
// API è°ƒç”¨é“¾
const result = await pipeAsync(
  userId,
  fetchUserById,           // async
  validateUser,            // sync
  enrichWithProfile,       // async
  saveToDatabase          // async
)

// æ–‡ä»¶å¤„ç†
const processFile = async (filename) => await pipeAsync(
  filename,
  readFile,               // async
  parseJSON,              // sync
  validateSchema,         // sync
  transformData,          // sync
  writeToDatabase         // async
)
```

---

### 3. compose - ä»å³åˆ°å·¦çš„å‡½æ•°ç»„åˆ

**ç­¾å**ï¼š
```typescript
compose<T>(...fns: Array<(arg: any) => any>): (value: T) => any
```

**ç”¨é€”**ï¼šæ•°å­¦é£æ ¼çš„å‡½æ•°ç»„åˆï¼ˆf âˆ˜ g = f(g(x))ï¼‰

**ä½¿ç”¨åœºæ™¯**ï¼š
- æ•°å­¦è®¡ç®—
- éœ€è¦å…ˆå®šä¹‰ç»„åˆï¼Œåä¼ å…¥æ•°æ®

**ä»£ç ç¤ºä¾‹**ï¼š
```typescript
// åŸºç¡€ç”¨æ³•ï¼ˆæ³¨æ„æ‰§è¡Œé¡ºåºæ˜¯ä»å³åˆ°å·¦ï¼‰
const double = (x: number) => x * 2
const addTen = (x: number) => x + 10
const compute = compose(addTen, double)
compute(5) // (5 * 2) + 10 = 20

// åˆ›å»ºå¯å¤ç”¨çš„è½¬æ¢å‡½æ•°
const processData = compose(
  JSON.stringify,    // 3. æœ€ååºåˆ—åŒ–
  normalizeData,     // 2. ç„¶åæ ‡å‡†åŒ–
  parseCSV          // 1. å…ˆè§£æ CSV
)

processData(csvString)
```

---

### 4. curry - æŸ¯é‡ŒåŒ–

**ç­¾å**ï¼š
```typescript
curry(fn: (...args: any[]) => any): (...args: any[]) => any
```

**ç”¨é€”**ï¼šå°†å¤šå‚æ•°å‡½æ•°è½¬æ¢ä¸ºå•å‚æ•°å‡½æ•°åºåˆ—

**ä½¿ç”¨åœºæ™¯**ï¼š
- åˆ›å»ºä¸“ç”¨å‡½æ•°
- å‚æ•°å¤ç”¨
- å‡½æ•°å¼ç¼–ç¨‹é£æ ¼

**ä»£ç ç¤ºä¾‹**ï¼š
```typescript
// åŸºç¡€ç”¨æ³•
const add = (a: number, b: number, c: number) => a + b + c
const curriedAdd = curry(add)

curriedAdd(1)(2)(3)        // 6
curriedAdd(1, 2)(3)        // 6
curriedAdd(1)(2, 3)        // 6

// åˆ›å»ºä¸“ç”¨å‡½æ•°
const add5 = curriedAdd(5)
add5(10)(3)                // 18
add5(2, 3)                 // 10

// å®é™…åº”ç”¨ï¼šæ•°æ®è¿‡æ»¤
const filterBy = curry((prop, value, arr) =>
  arr.filter(item => item[prop] === value)
)

const users = [
  { name: 'Alice', role: 'admin' },
  { name: 'Bob', role: 'user' },
  { name: 'Charlie', role: 'admin' }
]

const getAdmins = filterBy('role')('admin')
getAdmins(users) // [{ name: 'Alice', ... }, { name: 'Charlie', ... }]

const getByName = filterBy('name')
getByName('Bob')(users) // [{ name: 'Bob', role: 'user' }]
```

---

### 5. partial - éƒ¨åˆ†åº”ç”¨

**ç­¾å**ï¼š
```typescript
partial<T>(fn: T, ...fixedArgs: any[]): (...remainingArgs: any[]) => any
```

**ç”¨é€”**ï¼šå›ºå®šå‡½æ•°çš„éƒ¨åˆ†å‚æ•°

**ä½¿ç”¨åœºæ™¯**ï¼š
- ç®€å•çš„å‚æ•°é¢„å¡«å……
- æ¯” curry æ›´ç›´æ¥

**ä»£ç ç¤ºä¾‹**ï¼š
```typescript
// åŸºç¡€ç”¨æ³•
const multiply = (a: number, b: number, c: number) => a * b * c
const multiplyBy2 = partial(multiply, 2)
multiplyBy2(3, 4) // 2 * 3 * 4 = 24

// å®é™…åº”ç”¨ï¼šæ—¥å¿—å‡½æ•°
const log = (level: string, module: string, message: string) => {
  console.log(`[${level}] [${module}] ${message}`)
}

const errorLog = partial(log, 'ERROR')
const userError = partial(errorLog, 'USER')

userError('Login failed') // [ERROR] [USER] Login failed

// API è¯·æ±‚
const apiRequest = (method: string, endpoint: string, data: any) => {
  return fetch(endpoint, { method, body: JSON.stringify(data) })
}

const postRequest = partial(apiRequest, 'POST')
postRequest('/api/users', { name: 'Alice' })
```

---

### 6. tap - æ‰§è¡Œå‰¯ä½œç”¨ï¼ˆæ”¯æŒè‡ªåŠ¨ Promise è§£åŒ…ï¼‰

**ç­¾å**ï¼š
```typescript
// è¾…åŠ©ç±»å‹ï¼šæå– Promise ä¸­çš„ç±»å‹
type UnwrapPromise<T> = T extends Promise<infer U> ? U : T

// ç»Ÿä¸€ç­¾å - å‰¯ä½œç”¨å‡½æ•°æ¥æ”¶è§£åŒ…åçš„ç±»å‹
tap<T>(fn: (value: UnwrapPromise<T>) => void | Promise<void>): (value: T) => T
```

**ç”¨é€”**ï¼šåœ¨æ•°æ®æµä¸­æ‰§è¡Œå‰¯ä½œç”¨ï¼ˆå¦‚æ—¥å¿—ã€è°ƒè¯•ï¼‰ï¼Œä½†ä¸æ”¹å˜æ•°æ®

**ç‰¹æ€§**ï¼š
- ğŸ¯ **è‡ªåŠ¨ Promise è§£åŒ…**ï¼šå¦‚æœè¾“å…¥æ˜¯ Promiseï¼Œè‡ªåŠ¨è§£åŒ…åä¼ é€’ç»™å‰¯ä½œç”¨å‡½æ•°
- æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥å‰¯ä½œç”¨å‡½æ•°
- TypeScript ç±»å‹æ¨æ–­ä¼˜åŒ–ï¼ˆä½¿ç”¨ `UnwrapPromise<T>`ï¼‰
- ä¿æŒåŸå€¼ä¸å˜ï¼Œå§‹ç»ˆè¿”å›è¾“å…¥å€¼

**ä½¿ç”¨åœºæ™¯**ï¼š
- è°ƒè¯• pipe é“¾ä¸­çš„å¼‚æ­¥æ“ä½œ
- æ—¥å¿—è®°å½•ï¼ˆæ”¯æŒ Promise è‡ªåŠ¨è§£åŒ…ï¼‰
- ç›‘æ§æ•°æ®æµ
- å¼‚æ­¥æ—¥å¿—ï¼ˆå¦‚æ•°æ®åº“è®°å½•ï¼‰

**ä»£ç ç¤ºä¾‹**ï¼š
```typescript
// åœ¨ pipe ä¸­è°ƒè¯•
const result = pipe(
  [1, 2, 3, 4, 5],
  tap(x => console.log('Original:', x)),
  arr => arr.map(x => x * 2),
  tap(x => console.log('After double:', x)),
  arr => arr.filter(x => x > 5),
  tap(x => console.log('After filter:', x)),
  arr => arr.reduce((sum, x) => sum + x, 0)
)

// ğŸ¯ å…³é”®ç‰¹æ€§ï¼šè‡ªåŠ¨ Promise è§£åŒ…
const processUser = await pipe(
  userId,
  tap(id => console.log('User ID:', id)),        // id: number

  async id => await fetchUser(id),                // è¿”å› Promise<User>

  // âœ… user è‡ªåŠ¨è§£åŒ…ä¸º User ç±»å‹ï¼Œè€Œé Promise<User>
  tap(user => {
    console.log('Name:', user.name)               // å¯ä»¥ç›´æ¥è®¿é—®å±æ€§
    console.log('Email:', user.email)             // TypeScript æ­£ç¡®æ¨æ–­
  }),

  async user => await enrichUser(user),           // è¿”å› Promise<EnrichedUser>

  // âœ… å†æ¬¡è‡ªåŠ¨è§£åŒ…
  tap(enrichedUser => {
    console.log('Role:', enrichedUser.role)       // æ­£ç¡®æ¨æ–­æ–°å±æ€§
    console.log('Verified:', enrichedUser.verified)
  }),

  // æ··åˆåŒæ­¥å’Œå¼‚æ­¥ tap
  tap(async user => {
    await saveToDatabase(user)
    console.log('Saved to database')
  })
)

// æ€§èƒ½ç›‘æ§
const processData = pipe(
  data,
  tap(() => console.time('validation')),
  validateData,
  tap(() => console.timeEnd('validation')),
  tap(() => console.time('transformation')),
  transformData,
  tap(() => console.timeEnd('transformation'))
)
```

---

### 7. identity - è¿”å›è¾“å…¥å€¼

**ç­¾å**ï¼š
```typescript
identity<T>(value: T): T
```

**ç”¨é€”**ï¼šè¿”å›è¾“å…¥å€¼æœ¬èº«ï¼Œä¸åšä»»ä½•æ”¹å˜

**ä½¿ç”¨åœºæ™¯**ï¼š
- è¿‡æ»¤å‡å€¼
- é»˜è®¤å‡½æ•°
- å‡½æ•°ç»„åˆçš„å ä½ç¬¦

**ä»£ç ç¤ºä¾‹**ï¼š
```typescript
// åŸºç¡€ç”¨æ³•
identity(42)        // 42
identity("hello")   // "hello"
identity([1, 2])    // [1, 2]

// è¿‡æ»¤å‡å€¼
const data = [1, 2, null, 3, undefined, 4, 0, false, 5]
data.filter(identity) // [1, 2, 3, 4, 5]

// é»˜è®¤å‡½æ•°
const applyTransform = (value, transform = identity) => transform(value)
applyTransform(10)           // 10
applyTransform(10, x => x * 2) // 20

// æå–æ•°ç»„ä¸­çš„å€¼
const pairs = [['a', 1], ['b', 2], ['c', 3]]
pairs.map(([key, value]) => value) // å¯ä»¥ç®€åŒ–ä¸º:
pairs.map(identity) // å½“éœ€è¦ä¿æŒåŸæ ·æ—¶
```

---

### 8. constant - è¿”å›å¸¸é‡å‡½æ•°

**ç­¾å**ï¼š
```typescript
constant<T>(value: T): () => T
```

**ç”¨é€”**ï¼šåˆ›å»ºä¸€ä¸ªå§‹ç»ˆè¿”å›ç›¸åŒå€¼çš„å‡½æ•°

**ä½¿ç”¨åœºæ™¯**ï¼š
- é»˜è®¤å€¼
- æ•°ç»„å¡«å……
- äº‹ä»¶å¤„ç†

**ä»£ç ç¤ºä¾‹**ï¼š
```typescript
// åŸºç¡€ç”¨æ³•
const getTrue = constant(true)
getTrue() // true
getTrue() // true

const get42 = constant(42)
get42() // 42

// æ•°ç»„å¡«å……
[1, 2, 3].map(constant('x'))     // ['x', 'x', 'x']
Array(5).fill(0).map(constant({})) // [{}, {}, {}, {}, {}]

// é»˜è®¤å€¼
const getUserRole = (user) => user.role || constant('guest')()

// React äº‹ä»¶å¤„ç†
<button onClick={constant(console.log('Clicked!'))}>
  Click me
</button>
```

---

### 9. memoize - ç¼“å­˜å‡½æ•°ç»“æœ

**ç­¾å**ï¼š
```typescript
memoize<T, R>(fn: (arg: T) => R): (arg: T) => R
```

**ç”¨é€”**ï¼šç¼“å­˜å‡½æ•°ç»“æœä»¥é¿å…é‡å¤è®¡ç®—ï¼ˆä»…æ”¯æŒå•å‚æ•°å‡½æ•°ï¼‰

**ä½¿ç”¨åœºæ™¯**ï¼š
- æ˜‚è´µçš„è®¡ç®—
- é€’å½’ä¼˜åŒ–
- API å“åº”ç¼“å­˜

**ä»£ç ç¤ºä¾‹**ï¼š
```typescript
// æ–æ³¢é‚£å¥‘æ•°åˆ—ä¼˜åŒ–
const fibonacci = memoize((n: number): number => {
  if (n <= 1) return n
  return fibonacci(n - 1) + fibonacci(n - 2)
})

fibonacci(40) // ç¬¬ä¸€æ¬¡è®¡ç®—
fibonacci(40) // ç«‹å³è¿”å›ç¼“å­˜ç»“æœ

// æ˜‚è´µçš„æ•°æ®è½¬æ¢
const processLargeData = memoize((data: string) => {
  // å¤æ‚çš„è§£æå’Œè½¬æ¢
  return JSON.parse(data).map(transform).filter(validate)
})

// API å“åº”ç¼“å­˜
const fetchUser = memoize(async (userId: string) => {
  const response = await fetch(`/api/users/${userId}`)
  return response.json()
})

// åŒä¸€ç”¨æˆ·å¤šæ¬¡è°ƒç”¨ï¼Œåªå‘é€ä¸€æ¬¡è¯·æ±‚
fetchUser('123')
fetchUser('123') // ä½¿ç”¨ç¼“å­˜
```

---

### 10. debounce - é˜²æŠ–

**ç­¾å**ï¼š
```typescript
debounce<T>(fn: T, delayMs: number): (...args: Parameters<T>) => void
```

**ç”¨é€”**ï¼šå»¶è¿Ÿæ‰§è¡Œå‡½æ•°ï¼Œç›´åˆ°åœæ­¢è°ƒç”¨ä¸€æ®µæ—¶é—´åæ‰æ‰§è¡Œ

**ä½¿ç”¨åœºæ™¯**ï¼š
- æœç´¢è¾“å…¥æ¡†
- è‡ªåŠ¨ä¿å­˜
- çª—å£è°ƒæ•´å¤§å°

**ä»£ç ç¤ºä¾‹**ï¼š
```typescript
// æœç´¢è¾“å…¥
const searchAPI = debounce((query: string) => {
  fetch(`/api/search?q=${query}`)
}, 300)

input.addEventListener('input', (e) => searchAPI(e.target.value))
// ç”¨æˆ·å¿«é€Ÿè¾“å…¥ "hello"ï¼Œåªæœ‰æœ€åä¸€æ¬¡åœ¨ 300ms åæ‰§è¡Œ

// è‡ªåŠ¨ä¿å­˜
const autoSave = debounce((content: string) => {
  localStorage.setItem('draft', content)
}, 1000)

textarea.addEventListener('input', (e) => autoSave(e.target.value))

// çª—å£è°ƒæ•´å¤§å°
const handleResize = debounce(() => {
  console.log('Window resized to:', window.innerWidth)
}, 500)

window.addEventListener('resize', handleResize)
```

---

### 11. throttle - èŠ‚æµ

**ç­¾å**ï¼š
```typescript
throttle<T>(fn: T, delayMs: number): (...args: Parameters<T>) => void
```

**ç”¨é€”**ï¼šé™åˆ¶å‡½æ•°æ‰§è¡Œé¢‘ç‡ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æœ€å¤šæ‰§è¡Œä¸€æ¬¡

**ä½¿ç”¨åœºæ™¯**ï¼š
- æ»šåŠ¨äº‹ä»¶
- é¼ æ ‡ç§»åŠ¨
- é¢‘ç¹è§¦å‘çš„äº‹ä»¶

**ä»£ç ç¤ºä¾‹**ï¼š
```typescript
// æ»šåŠ¨äº‹ä»¶
const logScroll = throttle(() => {
  console.log('Scroll position:', window.scrollY)
}, 1000)

window.addEventListener('scroll', logScroll)
// æ— è®ºæ»šåŠ¨é¢‘ç‡å¦‚ä½•ï¼Œæ¯ç§’æœ€å¤šæ‰§è¡Œä¸€æ¬¡

// é¼ æ ‡ç§»åŠ¨
const trackMouse = throttle((e: MouseEvent) => {
  console.log('Mouse at:', e.clientX, e.clientY)
}, 100)

document.addEventListener('mousemove', trackMouse)

// API è¯·æ±‚é™åˆ¶
const sendAnalytics = throttle((event: string) => {
  fetch('/api/analytics', {
    method: 'POST',
    body: JSON.stringify({ event })
  })
}, 5000)

// é¢‘ç¹ç‚¹å‡»ï¼Œä½†æ¯ 5 ç§’æœ€å¤šå‘é€ä¸€æ¬¡
button.addEventListener('click', () => sendAnalytics('button_click'))
```

---

## ç»„åˆä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šç”¨æˆ·æ³¨å†Œæµç¨‹

```typescript
import { pipe, tap } from '@about-me/fp'

// åŒæ­¥éªŒè¯
const validateRegistration = pipe(
  input,
  tap(x => console.log('Input:', x)),
  validateEmail,
  validatePassword,
  tap(x => console.log('Validated:', x)),
  sanitizeInput
)

// å¼‚æ­¥å¤„ç†ï¼ˆpipe è‡ªåŠ¨å¤„ç†å¼‚æ­¥ï¼‰
const processRegistration = async (data) => await pipe(
  data,
  validateRegistration,
  async data => await checkEmailExists(data),
  async data => await hashPassword(data),
  async data => await createUser(data),
  async user => await sendWelcomeEmail(user)
)
```

### ç¤ºä¾‹ 2ï¼šæ•°æ®å¤„ç†ç®¡é“

```typescript
import { pipe, curry, tap, memoize } from '@about-me/fp'

// åˆ›å»ºè¿‡æ»¤å™¨
const filterBy = curry((prop, value, arr) =>
  arr.filter(item => item[prop] === value)
)

// ç¼“å­˜æ˜‚è´µçš„è½¬æ¢
const transformData = memoize((data) => {
  return pipe(
    data,
    tap(x => console.log('Processing:', x.length, 'items')),
    filterBy('active')(true),
    arr => arr.map(enrichWithMetadata),
    arr => arr.sort((a, b) => b.score - a.score),
    tap(x => console.log('Result:', x.length, 'items'))
  )
})
```

### ç¤ºä¾‹ 3ï¼šæœç´¢åŠŸèƒ½

```typescript
import { debounce, pipe, tap } from '@about-me/fp'

const processSearch = pipe(
  query => query.trim().toLowerCase(),
  tap(x => console.log('Search query:', x)),
  searchDatabase,
  filterResults,
  sortByRelevance
)

const debouncedSearch = debounce(processSearch, 300)

searchInput.addEventListener('input', (e) => {
  debouncedSearch(e.target.value)
})
```

---

## æœ€ä½³å®è·µ

### 1. ä¼˜å…ˆä½¿ç”¨ pipe è€Œä¸æ˜¯åµŒå¥—è°ƒç”¨

ä¸æ¨èï¼š
```typescript
const result = transform3(transform2(transform1(data)))
```

æ¨èï¼š
```typescript
const result = pipe(
  data,
  transform1,
  transform2,
  transform3
)
```

### 2. ä½¿ç”¨ tap è¿›è¡Œè°ƒè¯•

```typescript
const result = pipe(
  data,
  transform1,
  tap(x => console.log('After transform1:', x)), // è°ƒè¯•ç‚¹
  transform2,
  tap(x => console.log('After transform2:', x))  // è°ƒè¯•ç‚¹
)
```

### 3. ç»„åˆ curry å’Œ pipe åˆ›å»ºå¯å¤ç”¨å‡½æ•°

```typescript
const filterBy = curry((prop, value, arr) =>
  arr.filter(item => item[prop] === value)
)

const processUsers = pipe(
  filterBy('active')(true),
  users => users.map(enrichUser),
  users => users.sort(byName)
)
```

### 4. ä½¿ç”¨ memoize ä¼˜åŒ–æ˜‚è´µè®¡ç®—

```typescript
const expensiveComputation = memoize((data) => {
  // å¤æ‚è®¡ç®—
  return result
})
```

### 5. å¯¹ç”¨æˆ·è¾“å…¥ä½¿ç”¨ debounce

```typescript
const handleSearch = debounce((query) => {
  searchAPI(query)
}, 300)
```

### 6. å¯¹é«˜é¢‘äº‹ä»¶ä½¿ç”¨ throttle

```typescript
const handleScroll = throttle(() => {
  updateScrollIndicator()
}, 100)
```

---

## ç±»å‹å®‰å…¨

æ‰€æœ‰å‡½æ•°éƒ½æœ‰å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰ï¼š

```typescript
// ç±»å‹æ¨å¯¼
const result = pipe(
  5,           // number
  x => x * 2,  // number -> number
  x => String(x) // number -> string
) // result ç±»å‹ä¸º string

// æ³›å‹æ”¯æŒ
const memoized = memoize((x: number) => x * 2)
// memoized ç±»å‹ä¸º (arg: number) => number
```

---

## æ³¨æ„äº‹é¡¹

1. **memoize ä»…æ”¯æŒå•å‚æ•°å‡½æ•°**
   - å¦‚éœ€å¤šå‚æ•°ï¼Œä½¿ç”¨ curry æˆ– partial å…ˆè½¬æ¢

2. **debounce å’Œ throttle ä¼šä¸¢å¤±è¿”å›å€¼**
   - å®ƒä»¬ä¸»è¦ç”¨äºå‰¯ä½œç”¨ï¼Œä¸é€‚åˆéœ€è¦è¿”å›å€¼çš„åœºæ™¯

3. **pipe å’Œ compose çš„å‚æ•°é¡ºåºç›¸å**
   - pipe: ä»å·¦åˆ°å³ï¼ˆæ•°æ®æµå‘ï¼‰
   - compose: ä»å³åˆ°å·¦ï¼ˆæ•°å­¦é£æ ¼ï¼‰

4. **pipe è‡ªåŠ¨å¤„ç†å¼‚æ­¥æ“ä½œ**
   - é‡åˆ° Promise æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°å¼‚æ­¥æ¨¡å¼
   - ç¡®ä¿æ¯ä¸ªå‡½æ•°éƒ½æ­£ç¡®å¤„ç†é”™è¯¯

---

## å¸¸è§æ¨¡å¼

### æ¨¡å¼ 1ï¼šæ¡ä»¶æ‰§è¡Œ

```typescript
const processData = (data, shouldTransform) => pipe(
  data,
  x => shouldTransform ? transform(x) : x,
  normalize,
  validate
)
```

### æ¨¡å¼ 2ï¼šé”™è¯¯å¤„ç†

```typescript
const safeProcess = async (data) => {
  try {
    return await pipe(
      data,
      validate,
      async data => await transform(data),
      async data => await save(data)
    )
  } catch (error) {
    console.error('Processing failed:', error)
    return null
  }
}
```

### æ¨¡å¼ 3ï¼šç»„åˆå¤šä¸ªå·¥å…·

```typescript
const smartSearch = debounce(
  curry((filters, query, dataset) =>
    pipe(
      dataset,
      filterBy('query')(query),
      filterBy('category')(filters.category),
      sortByRelevance
    )
  ),
  300
)
```

